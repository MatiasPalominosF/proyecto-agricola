<div class="app-content content">
  <div class="content-wrapper">
    <div class="content-header row mb-1">
      <app-breadcrumb class="col-12" [breadcrumb]="breadcrumb"></app-breadcrumb>
    </div>
    <div class="content-body">
      <div class="row">
        <div class="col-md-12">
          <m-card [options]="options" (reloadFunction)="reload($event)">
            <ng-container mCardHeaderTitle>
              Categorías disponibles
            </ng-container>
            <ng-container mCardBody>
              <div class="col-md-12">
                <div class="d-flex justify-content-between">
                  <form>
                    <div class="form-group form-inline">
                      Buscar:
                      <input
                        class="form-control ml-2"
                        [formControl]="filter"
                        type="text"
                      />
                    </div>
                  </form>
                  <button
                    type="button"
                    class="btn btn-primary btn-min-width ml-1 mr-1 mb-1"
                    onclick=""
                  >
                    <i class="la la-plus"></i> Crear categoría
                  </button>
                </div>
              </div>
              <div
                class="table-responsive card-body"
                *blockUI="'categoriesCard'; message: 'Loading'"
              >
                <table class="table table-striped">
                  <thead>
                    <tr>
                      <th *ngFor="let head of headElements" scope="col">
                        {{ head }}
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr
                      mdbTableCol
                      *ngFor="
                        let element of harvestSearch
                          | async
                          | slice
                            : (page - 1) * pageSize
                            : (page - 1) * pageSize + pageSize;
                        index as i
                      "
                    >
                      <th scope="row">{{ i + 1 }}</th>
                      <td>
                        <ngb-highlight
                          [result]="element.name"
                          [term]="filter.value"
                        >
                        </ngb-highlight>
                      </td>
                      <td>
                        <ngb-highlight
                          [result]="
                            element.dateStart.toDate()
                              | date: 'dd/MM/yyyy HH:mm'
                          "
                          [term]="
                            element.dateStart.toDate()
                              | date: 'dd/MM/yyyy HH:mm'
                          "
                        >
                        </ngb-highlight>
                      </td>
                      <td>
                        <div
                          *ngIf="element.dateEnd == null; else elseBlock"
                          class="
                            badge
                            border-left-info border-right-info
                            round
                            badge-striped
                          "
                        >
                          <i class="la la-clock-o font-medium-2"></i>
                          <span>En proceso...</span>
                        </div>
                        <ng-template #elseBlock
                          ><ngb-highlight
                            [result]="
                              element.dateEnd.toDate()
                                | date: 'dd/MM/yyyy HH:mm'
                            "
                            [term]="
                              element.dateEnd.toDate()
                                | date: 'dd/MM/yyyy HH:mm'
                            "
                          >
                          </ngb-highlight
                        ></ng-template>
                      </td>
                      <td>
                        <div class="d-flex justify-content-between">
                          <button
                            type="button"
                            (click)="delete(element.id)"
                            class="btn btn-outline-danger btn-sm"
                            triggers="hover:click:hover"
                            [autoClose]="'outside'"
                            ngbTooltip="Eliminar"
                          >
                            x
                          </button>
                        </div>
                      </td>
                    </tr>
                  </tbody>
                </table>
                <div class="d-flex justify-content-between p-2">
                  <ngb-pagination
                    [collectionSize]="collectionSize"
                    [(page)]="page"
                    [pageSize]="pageSize"
                  >
                  </ngb-pagination>

                  <select
                    class="custom-select"
                    style="width: auto"
                    [(ngModel)]="pageSize"
                  >
                    <option [ngValue]="collectionSize">
                      Mostrar todos los ítems
                    </option>
                    <option [ngValue]="2">2 ítems por página</option>
                    <option [ngValue]="4">4 ítems por página</option>
                    <option [ngValue]="6">6 ítems por página</option>
                  </select>
                </div>
              </div>
            </ng-container>
          </m-card>
        </div>
      </div>
    </div>
  </div>
</div>
