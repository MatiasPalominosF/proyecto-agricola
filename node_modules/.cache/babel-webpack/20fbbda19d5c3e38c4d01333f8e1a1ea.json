{"ast":null,"code":"import _toConsumableArray from \"C:/Users/matia/Desktop/Proyecto/proyecto-agricola/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"C:/Users/matia/Desktop/Proyecto/proyecto-agricola/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:/Users/matia/Desktop/Proyecto/proyecto-agricola/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport { from } from 'rxjs';\nimport { fromCollectionRef } from '../observable/fromRef';\nimport { map, filter, scan, observeOn } from 'rxjs/operators';\nimport { validateEventsArray } from '../collection/collection';\nimport { docChanges, sortedChanges } from '../collection/changes';\nexport var AngularFirestoreCollectionGroup = /*#__PURE__*/function () {\n  function AngularFirestoreCollectionGroup(query, afs) {\n    _classCallCheck(this, AngularFirestoreCollectionGroup);\n\n    this.query = query;\n    this.afs = afs;\n  }\n\n  _createClass(AngularFirestoreCollectionGroup, [{\n    key: \"stateChanges\",\n    value: function stateChanges(events) {\n      if (!events || events.length === 0) {\n        return docChanges(this.query, this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst);\n      }\n\n      return docChanges(this.query, this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst, map(function (actions) {\n        return actions.filter(function (change) {\n          return events.indexOf(change.type) > -1;\n        });\n      }), filter(function (changes) {\n        return changes.length > 0;\n      }));\n    }\n  }, {\n    key: \"auditTrail\",\n    value: function auditTrail(events) {\n      return this.stateChanges(events).pipe(scan(function (current, action) {\n        return [].concat(_toConsumableArray(current), _toConsumableArray(action));\n      }, []));\n    }\n  }, {\n    key: \"snapshotChanges\",\n    value: function snapshotChanges(events) {\n      var validatedEvents = validateEventsArray(events);\n      var scheduledSortedChanges$ = sortedChanges(this.query, validatedEvents, this.afs.schedulers.outsideAngular);\n      return scheduledSortedChanges$.pipe(this.afs.keepUnstableUntilFirst);\n    }\n  }, {\n    key: \"valueChanges\",\n    value: function valueChanges() {\n      var fromCollectionRefScheduled$ = fromCollectionRef(this.query, this.afs.schedulers.outsideAngular);\n      return fromCollectionRefScheduled$.pipe(this.afs.keepUnstableUntilFirst, map(function (actions) {\n        return actions.payload.docs.map(function (a) {\n          return a.data();\n        });\n      }));\n    }\n  }, {\n    key: \"get\",\n    value: function get(options) {\n      return from(this.query.get(options)).pipe(observeOn(this.afs.schedulers.insideAngular));\n    }\n  }]);\n\n  return AngularFirestoreCollectionGroup;\n}(); //# sourceMappingURL=collection-group.js.map","map":{"version":3,"sources":["C:/Users/matia/Desktop/Proyecto/proyecto-agricola/node_modules/@angular/fire/firestore/es2015/collection-group/collection-group.js"],"names":["from","fromCollectionRef","map","filter","scan","observeOn","validateEventsArray","docChanges","sortedChanges","AngularFirestoreCollectionGroup","query","afs","events","length","schedulers","outsideAngular","pipe","keepUnstableUntilFirst","actions","change","indexOf","type","changes","stateChanges","current","action","validatedEvents","scheduledSortedChanges$","fromCollectionRefScheduled$","payload","docs","a","data","options","get","insideAngular"],"mappings":";;;AAAA,SAASA,IAAT,QAAqB,MAArB;AACA,SAASC,iBAAT,QAAkC,uBAAlC;AACA,SAASC,GAAT,EAAcC,MAAd,EAAsBC,IAAtB,EAA4BC,SAA5B,QAA6C,gBAA7C;AACA,SAASC,mBAAT,QAAoC,0BAApC;AACA,SAASC,UAAT,EAAqBC,aAArB,QAA0C,uBAA1C;AACA,WAAaC,+BAAb;AACI,2CAAYC,KAAZ,EAAmBC,GAAnB,EAAwB;AAAA;;AACpB,SAAKD,KAAL,GAAaA,KAAb;AACA,SAAKC,GAAL,GAAWA,GAAX;AACH;;AAJL;AAAA;AAAA,WAKI,sBAAaC,MAAb,EAAqB;AACjB,UAAI,CAACA,MAAD,IAAWA,MAAM,CAACC,MAAP,KAAkB,CAAjC,EAAoC;AAChC,eAAON,UAAU,CAAC,KAAKG,KAAN,EAAa,KAAKC,GAAL,CAASG,UAAT,CAAoBC,cAAjC,CAAV,CAA2DC,IAA3D,CAAgE,KAAKL,GAAL,CAASM,sBAAzE,CAAP;AACH;;AACD,aAAOV,UAAU,CAAC,KAAKG,KAAN,EAAa,KAAKC,GAAL,CAASG,UAAT,CAAoBC,cAAjC,CAAV,CACFC,IADE,CACG,KAAKL,GAAL,CAASM,sBADZ,EACoCf,GAAG,CAAC,UAAAgB,OAAO;AAAA,eAAIA,OAAO,CAACf,MAAR,CAAe,UAAAgB,MAAM;AAAA,iBAAIP,MAAM,CAACQ,OAAP,CAAeD,MAAM,CAACE,IAAtB,IAA8B,CAAC,CAAnC;AAAA,SAArB,CAAJ;AAAA,OAAR,CADvC,EACgHlB,MAAM,CAAC,UAAAmB,OAAO;AAAA,eAAIA,OAAO,CAACT,MAAR,GAAiB,CAArB;AAAA,OAAR,CADtH,CAAP;AAEH;AAXL;AAAA;AAAA,WAYI,oBAAWD,MAAX,EAAmB;AACf,aAAO,KAAKW,YAAL,CAAkBX,MAAlB,EAA0BI,IAA1B,CAA+BZ,IAAI,CAAC,UAACoB,OAAD,EAAUC,MAAV;AAAA,4CAAyBD,OAAzB,sBAAqCC,MAArC;AAAA,OAAD,EAA+C,EAA/C,CAAnC,CAAP;AACH;AAdL;AAAA;AAAA,WAeI,yBAAgBb,MAAhB,EAAwB;AACpB,UAAMc,eAAe,GAAGpB,mBAAmB,CAACM,MAAD,CAA3C;AACA,UAAMe,uBAAuB,GAAGnB,aAAa,CAAC,KAAKE,KAAN,EAAagB,eAAb,EAA8B,KAAKf,GAAL,CAASG,UAAT,CAAoBC,cAAlD,CAA7C;AACA,aAAOY,uBAAuB,CAACX,IAAxB,CAA6B,KAAKL,GAAL,CAASM,sBAAtC,CAAP;AACH;AAnBL;AAAA;AAAA,WAoBI,wBAAe;AACX,UAAMW,2BAA2B,GAAG3B,iBAAiB,CAAC,KAAKS,KAAN,EAAa,KAAKC,GAAL,CAASG,UAAT,CAAoBC,cAAjC,CAArD;AACA,aAAOa,2BAA2B,CAC7BZ,IADE,CACG,KAAKL,GAAL,CAASM,sBADZ,EACoCf,GAAG,CAAC,UAAAgB,OAAO;AAAA,eAAIA,OAAO,CAACW,OAAR,CAAgBC,IAAhB,CAAqB5B,GAArB,CAAyB,UAAA6B,CAAC;AAAA,iBAAIA,CAAC,CAACC,IAAF,EAAJ;AAAA,SAA1B,CAAJ;AAAA,OAAR,CADvC,CAAP;AAEH;AAxBL;AAAA;AAAA,WAyBI,aAAIC,OAAJ,EAAa;AACT,aAAOjC,IAAI,CAAC,KAAKU,KAAL,CAAWwB,GAAX,CAAeD,OAAf,CAAD,CAAJ,CAA8BjB,IAA9B,CAAmCX,SAAS,CAAC,KAAKM,GAAL,CAASG,UAAT,CAAoBqB,aAArB,CAA5C,CAAP;AACH;AA3BL;;AAAA;AAAA,I,CA6BA","sourcesContent":["import { from } from 'rxjs';\r\nimport { fromCollectionRef } from '../observable/fromRef';\r\nimport { map, filter, scan, observeOn } from 'rxjs/operators';\r\nimport { validateEventsArray } from '../collection/collection';\r\nimport { docChanges, sortedChanges } from '../collection/changes';\r\nexport class AngularFirestoreCollectionGroup {\r\n    constructor(query, afs) {\r\n        this.query = query;\r\n        this.afs = afs;\r\n    }\r\n    stateChanges(events) {\r\n        if (!events || events.length === 0) {\r\n            return docChanges(this.query, this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst);\r\n        }\r\n        return docChanges(this.query, this.afs.schedulers.outsideAngular)\r\n            .pipe(this.afs.keepUnstableUntilFirst, map(actions => actions.filter(change => events.indexOf(change.type) > -1)), filter(changes => changes.length > 0));\r\n    }\r\n    auditTrail(events) {\r\n        return this.stateChanges(events).pipe(scan((current, action) => [...current, ...action], []));\r\n    }\r\n    snapshotChanges(events) {\r\n        const validatedEvents = validateEventsArray(events);\r\n        const scheduledSortedChanges$ = sortedChanges(this.query, validatedEvents, this.afs.schedulers.outsideAngular);\r\n        return scheduledSortedChanges$.pipe(this.afs.keepUnstableUntilFirst);\r\n    }\r\n    valueChanges() {\r\n        const fromCollectionRefScheduled$ = fromCollectionRef(this.query, this.afs.schedulers.outsideAngular);\r\n        return fromCollectionRefScheduled$\r\n            .pipe(this.afs.keepUnstableUntilFirst, map(actions => actions.payload.docs.map(a => a.data())));\r\n    }\r\n    get(options) {\r\n        return from(this.query.get(options)).pipe(observeOn(this.afs.schedulers.insideAngular));\r\n    }\r\n}\r\n//# sourceMappingURL=collection-group.js.map"]},"metadata":{},"sourceType":"module"}